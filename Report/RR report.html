<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sevinj Guluyeva (444423)">
<meta name="author" content="Nijat Gurbanov (444424)">
<meta name="author" content="Berk Arikan (437954)">
<meta name="dcterms.date" content="2023-06-17">

<title>Predicting the salary of US data scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="RR report_files/libs/clipboard/clipboard.min.js"></script>
<script src="RR report_files/libs/quarto-html/quarto.js"></script>
<script src="RR report_files/libs/quarto-html/popper.min.js"></script>
<script src="RR report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RR report_files/libs/quarto-html/anchor.min.js"></script>
<link href="RR report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RR report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RR report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RR report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RR report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Predicting the salary of US data scientists</h1>
            <p class="subtitle lead">Reproducible Research report</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>Sevinj Guluyeva (444423) </p>
               <p>Nijat Gurbanov (444424) </p>
               <p>Berk Arikan (437954) </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 17, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#technical-information" id="toc-technical-information" class="nav-link" data-scroll-target="#technical-information"><span class="header-section-number">1.1</span> Technical Information</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">1.2</span> Libraries</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">2</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">2.1</span> Loading Data</a></li>
  <li><a href="#subsetting-data" id="toc-subsetting-data" class="nav-link" data-scroll-target="#subsetting-data"><span class="header-section-number">2.2</span> Subsetting Data</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">2.3</span> Data Cleaning</a></li>
  </ul></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">3</span> Data Visualization</a></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling"><span class="header-section-number">4</span> Modelling</a>
  <ul class="collapse">
  <li><a href="#original-model" id="toc-original-model" class="nav-link" data-scroll-target="#original-model"><span class="header-section-number">4.1</span> Original Model</a></li>
  <li><a href="#random-forest-model" id="toc-random-forest-model" class="nav-link" data-scroll-target="#random-forest-model"><span class="header-section-number">4.2</span> Random Forest Model</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">5</span> Conclusion</a>
  <ul class="collapse">
  <li><a href="#main-challanges-and-further-recommendations" id="toc-main-challanges-and-further-recommendations" class="nav-link" data-scroll-target="#main-challanges-and-further-recommendations"><span class="header-section-number">5.1</span> Main Challanges and Further Recommendations</a></li>
  </ul></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography"><span class="header-section-number">6</span> Bibliography</a>
  <ul class="collapse">
  <li><a href="#ai-tool" id="toc-ai-tool" class="nav-link" data-scroll-target="#ai-tool"><span class="header-section-number">6.1</span> AI tool</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>In this project we will try to analyze and predict the salary of US data scientists. Our analysis is based on the publicly available analysis in <a href="https://www.kaggle.com/code/mabs003/predicting-salary-of-data-scientists/notebook">Kaggle</a>. Our main aim is first to reproduce the results of the original analysis using R and then improve the study by updating the data and adding Random Forest for the prediction.</p>
<p>The original analysis was built on <a href="https://www.kaggle.com/competitions/kaggle-survey-2021">2021 Kaggle Machine Learning &amp; Data Science Survey</a>. This is the result of survey conducted by Kaggle on people who work with data. Only people who works in US was selected in this analysis as a subset for us to get a better insight about salary as the salary ranges are different from country to country. We also use <a href="https://www.kaggle.com/competitions/kaggle-survey-2022">2022 Kaggle Machine Learning &amp; Data Science Survey</a> data as a newer version of original data.</p>
<section id="technical-information" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="technical-information"><span class="header-section-number">1.1</span> Technical Information</h2>
<p><strong>Operating System:</strong></p>
<ul>
<li>Windows 11 Pro</li>
<li>macOS Ventura</li>
</ul>
<p><strong>Tools used:</strong></p>
<ul>
<li>RStudio 2023.06.0+421</li>
<li>Quarto v1.3.353</li>
</ul>
</section>
<section id="libraries" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="libraries"><span class="header-section-number">1.2</span> Libraries</h2>
<p>Following libraries are used in the analysis</p>
<ul>
<li>dplyr v1.0.10</li>
<li>tidyr v1.1.4</li>
<li>ggplot2 v3.3.6</li>
<li>caret v6.0.92</li>
<li>fastDummies v1.6.3</li>
<li>randomForest v4.7.1.1</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fastDummies)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="data-preparation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Preparation</h1>
<section id="loading-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="loading-data"><span class="header-section-number">2.1</span> Loading Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_old <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'../Models/Data/kaggle_survey_2021_responses.csv'</span>, <span class="at">encoding =</span> <span class="st">'UTF-8'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>data_old</code> is <a href="https://www.kaggle.com/competitions/kaggle-survey-2021">2021 Kaggle Machine Learning &amp; Data Science Survey</a>. It consists of 25,973 responses. Responses to each question saved either as a column with some categories or as a binary variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_new <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'../Models/Data/kaggle_survey_2022_responses.csv'</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>data_new</code> is <a href="https://www.kaggle.com/competitions/kaggle-survey-2021">2022 Kaggle Machine Learning &amp; Data Science Survey</a>. It consists of 23,997 responses. Responses to each question saved either as a column with some categories or as a binary variable. There are some differences in the order of questions and in available answers.</p>
</section>
<section id="subsetting-data" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="subsetting-data"><span class="header-section-number">2.2</span> Subsetting Data</h2>
<p>In original analysis not all available variables are used for predicting the salary. Only responses from US and following variables are used in this analysis:</p>
<ul>
<li>Age</li>
<li>Gender</li>
<li>Country_of_residence<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>Education</li>
<li>Job_title</li>
<li>Experience</li>
<li>Programming languages<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
<li>Salary_range</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the raw which has questions</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> data_old[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> data_new[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting only necessary variables</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> df_old[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">128</span>)]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> df_new[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">146</span>, <span class="dv">30</span><span class="sc">:</span><span class="dv">45</span>, <span class="dv">159</span>)]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Age'</span>, <span class="st">'Gender'</span>, <span class="st">'Country_of_residence'</span>, <span class="st">'Education'</span>, <span class="st">'Job_title'</span>, <span class="st">'Experience'</span>, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Python'</span>, <span class="st">'R'</span>, <span class="st">'SQL'</span>, <span class="st">'C'</span>, <span class="st">'C++'</span>, <span class="st">'Java'</span>, <span class="st">'Javascript'</span>, <span class="st">'Julia'</span>, <span class="st">'Swift'</span>, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Bash'</span>, <span class="st">'MATLAB'</span>, <span class="st">'None'</span>, <span class="st">'Other'</span>, <span class="st">'Salary_range'</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_old) <span class="ot">&lt;-</span> cols</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Age'</span>, <span class="st">'Gender'</span>, <span class="st">'Country_of_residence'</span>, <span class="st">'Education'</span>, <span class="st">'Job_title'</span>, <span class="st">'Experience'</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Python'</span>, <span class="st">'R'</span>, <span class="st">'SQL'</span>, <span class="st">'C'</span>, <span class="st">'C#'</span>, <span class="st">'C++'</span>, <span class="st">'Java'</span>, <span class="st">'Javascript'</span>, <span class="st">'Bash'</span>,<span class="st">'PHP'</span>, <span class="st">'MATLAB'</span>, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Julia'</span>, <span class="st">'Go'</span>, <span class="st">'None'</span>, <span class="st">'Other'</span>, <span class="st">'Salary_range'</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_new) <span class="ot">&lt;-</span> cols</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting only responses USA</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> df_old[df_old<span class="sc">$</span>Country_of_residence <span class="sc">==</span> <span class="st">'United States of America'</span>, ]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> df_new[df_new<span class="sc">$</span>Country_of_residence <span class="sc">==</span> <span class="st">'United States of America'</span>, ]</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">2.3</span> Data Cleaning</h2>
<p>There are some missing values in <code>Salary_range</code> column. We should exclude them from the data. Moreover, salary is given as a range, it is string variable. For a better prediction, we convert it to numeric variable. We create two variable from <code>Salary_range</code> column:</p>
<ul>
<li><code>Salary_min</code>: minimum salary in that range;</li>
<li><code>Salary_max</code>: maximum salary in that range.</li>
</ul>
<p>Then we created <code>Salary_est</code> variable which is a average salary in that range. And in the final step, we are selecting only salaries between $30K and $300K for eliminating the extreme values in data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing missing values from data</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> df_old[df_old<span class="sc">$</span>Salary_range <span class="sc">!=</span> <span class="st">""</span>, ]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> df_new[df_new<span class="sc">$</span>Salary_range <span class="sc">!=</span> <span class="st">""</span>, ]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting Salary_range variable into two numeric variable</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>temp1 <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(df_old<span class="sc">$</span>Salary_range, <span class="st">'-'</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Salary_min <span class="ot">&lt;-</span> <span class="fu">sapply</span>(temp1, <span class="st">'['</span>, <span class="dv">1</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Salary_max <span class="ot">&lt;-</span> <span class="fu">sapply</span>(temp1, <span class="st">'['</span>, <span class="dv">2</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(df_new<span class="sc">$</span>Salary_range, <span class="st">'-'</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a> df_new<span class="sc">$</span>Salary_min <span class="ot">&lt;-</span> <span class="fu">sapply</span>(temp2, <span class="st">'['</span>, <span class="dv">1</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Salary_max <span class="ot">&lt;-</span> <span class="fu">sapply</span>(temp2, <span class="st">'['</span>, <span class="dv">2</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleaning and converting those columns to numeric variable</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>replace_symbols <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="st">','</span>, <span class="st">''</span>, <span class="fu">gsub</span>(<span class="st">'$'</span>, <span class="st">''</span>, <span class="fu">gsub</span>(<span class="st">'&gt;'</span>, <span class="st">''</span>, x), <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Salary_min <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">replace_symbols</span>(df_old<span class="sc">$</span>Salary_min))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Salary_max <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">replace_symbols</span>(df_old<span class="sc">$</span>Salary_max))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Salary_min <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">replace_symbols</span>(df_new<span class="sc">$</span>Salary_min))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Salary_max <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">replace_symbols</span>(df_new<span class="sc">$</span>Salary_max))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a number for a maximum range</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Salary_max <span class="ot">&lt;-</span> <span class="fu">replace_na</span>(df_old<span class="sc">$</span>Salary_max, <span class="dv">1000001</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Salary_max <span class="ot">&lt;-</span> <span class="fu">replace_na</span>(df_new<span class="sc">$</span>Salary_max, <span class="dv">1000001</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating Salary_est variable</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Salary_est <span class="ot">&lt;-</span> (df_old<span class="sc">$</span>Salary_min <span class="sc">+</span> df_old<span class="sc">$</span>Salary_max <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Salary_est <span class="ot">&lt;-</span> (df_new<span class="sc">$</span>Salary_min <span class="sc">+</span> df_new<span class="sc">$</span>Salary_max <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting salary only in speicified range</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> df_old[df_old<span class="sc">$</span>Salary_est <span class="sc">&gt;</span> <span class="dv">30000</span> <span class="sc">&amp;</span> df_old<span class="sc">$</span>Salary_est <span class="sc">&lt;</span> <span class="dv">300000</span>, ]</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> df_new[df_new<span class="sc">$</span>Salary_est <span class="sc">&gt;</span> <span class="dv">30000</span> <span class="sc">&amp;</span> df_new<span class="sc">$</span>Salary_est <span class="sc">&lt;</span> <span class="dv">300000</span>, ]</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Programming values are not coded correctly in the data as a binary variable. We are correcting that by replacing column values with 0 and 1. Moreover there are some differences in the answers of original and new data. Previously, <strong>PHP</strong>, <strong>C#</strong> and <strong>Go</strong> languages are coded under <strong>Other</strong> variable, however now they are given as a separate variable. For us to use the original model, we should also code them under <strong>Other</strong> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Correcting binary variables</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>languages_old <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Python'</span>, <span class="st">'R'</span>, <span class="st">'SQL'</span>, <span class="st">'C'</span>, <span class="st">'C++'</span>, <span class="st">'Java'</span>, <span class="st">'Javascript'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Julia'</span>, <span class="st">'Swift'</span>, <span class="st">'Bash'</span>, <span class="st">'MATLAB'</span>, <span class="st">'None'</span>, <span class="st">'Other'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> languages_old) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  df_old[[i]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df_old[[i]] <span class="sc">==</span> i, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>languages_new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Python'</span>, <span class="st">'R'</span>, <span class="st">'SQL'</span>, <span class="st">'C'</span>, <span class="st">'C#'</span>, <span class="st">'C++'</span>, <span class="st">'Java'</span>, <span class="st">'Javascript'</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Bash'</span>,<span class="st">'PHP'</span>, <span class="st">'MATLAB'</span>, <span class="st">'Julia'</span>, <span class="st">'Go'</span>, <span class="st">'None'</span>, <span class="st">'Other'</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> languages_new) {</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  df_new[[i]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df_new[[i]] <span class="sc">==</span> i, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining PHP, C# and Go under Other variable</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Other <span class="ot">&lt;-</span> df_new<span class="sc">$</span>PHP <span class="sc">+</span> df_new<span class="sc">$</span><span class="st">`</span><span class="at">C#</span><span class="st">`</span> <span class="sc">+</span> df_new<span class="sc">$</span>Go <span class="sc">+</span> df_new<span class="sc">$</span>Other</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Other <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df_new<span class="sc">$</span>Other <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>PHP <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span><span class="st">`</span><span class="at">C#</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Go <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, <strong>Swift</strong> is recorded under <strong>Other</strong> variable in new data. We will create additional dummy variable in the modelling stage with only 0s for the new data.. As in original data, we had only 18 positive answers for <strong>Swift</strong>, this addition will not create a significant impact.</p>
</section>
</section>
<section id="data-visualization" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Visualization</h1>
<p>For understanding the main trends and differences in two years’ survey, we built some box plots. The following graphs show the relationship of salary with gender, education, job title, and experience.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Gender</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Education</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Job Title</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Experience</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_old, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Gender)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Gender 2021'</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_new, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Gender)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Gender 2022'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In general, salaries of men are higher than women. Moreover, salary of men increased compared to 2021, while salary of women has not changed that much in 2022.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_old, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Education)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Education 2021'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_new, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Education)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Education 2022'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In general, we observe an increase in overall salary for all education groups.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_old, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Job_title)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Job Title 2021'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_new, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Job_title)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Job Title 2022'</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There are some differences in job titles which will be solved in Modelling stage as well. We can observe that <em>Managers</em>, <em>Machine Learning Engineers</em> and <em>Data scientists</em> have higher salary than others in 2022 and they have increased compared to 2021.</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_old, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Experience)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Experience 2021'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_new, <span class="fu">aes</span>(<span class="at">x =</span> Salary_est, <span class="at">y =</span> Experience)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Salary vs Experience 2022'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="RR-report_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see an observable correlation between experience level with programming and the salary.</p>
</div>
</div>
</div>
</section>
<section id="modelling" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Modelling</h1>
<section id="original-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="original-model"><span class="header-section-number">4.1</span> Original Model</h2>
<section id="preparation-for-modelling" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="preparation-for-modelling"><span class="header-section-number">4.1.1</span> Preparation for Modelling</h3>
<p>We will separate predictors and predicted variables for both data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>X_old <span class="ot">&lt;-</span> df_old[, <span class="sc">!</span>(<span class="fu">names</span>(df_old) <span class="sc">%in%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">c</span>(<span class="st">'Gender'</span>, <span class="st">'Salary_range'</span>, <span class="st">'Salary_min'</span>, <span class="st">'Salary_max'</span>, <span class="st">'Salary_est'</span>))]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>y_old <span class="ot">&lt;-</span> df_old<span class="sc">$</span>Salary_est</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>X_old <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(X_old, <span class="at">select_columns =</span> <span class="fu">colnames</span>(X_old), <span class="at">remove_first_dummy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>X_old <span class="ot">&lt;-</span> X_old[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>)]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>X_new <span class="ot">&lt;-</span> df_new[, <span class="sc">!</span>(<span class="fu">names</span>(df_new) <span class="sc">%in%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">c</span>(<span class="st">'Gender'</span>, <span class="st">'Salary_range'</span>, <span class="st">'Salary_min'</span>, <span class="st">'Salary_max'</span>, <span class="st">'Salary_est'</span>))]</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>y_new <span class="ot">&lt;-</span> df_new<span class="sc">$</span>Salary_est</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>X_new <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(X_new, <span class="at">select_columns =</span> <span class="fu">colnames</span>(X_new), <span class="at">remove_first_dummy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>X_new <span class="ot">&lt;-</span> X_new[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>)]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We add job title <strong>Teacher/Professor</strong> and <strong>Engineer (non-software)</strong> to <strong>Other</strong> and remove them as we do not have that column in original model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>X_new<span class="sc">$</span>Job_title_Other <span class="ot">&lt;-</span> X_new<span class="sc">$</span><span class="st">`</span><span class="at">Job_title_Teacher / professor</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                          X_new<span class="sc">$</span><span class="st">`</span><span class="at">Job_title_Engineer (non-software)</span><span class="st">`</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>X_new<span class="sc">$</span><span class="st">`</span><span class="at">Job_title_Teacher / professor</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>X_new<span class="sc">$</span><span class="st">`</span><span class="at">Job_title_Engineer (non-software)</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following step is matching the job titles. The columns should have named in the same way for the original model to be run. Moreover, we are adding <strong>Swift</strong> because of the reason we discussed above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X_new)[</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">names</span>(X_new) <span class="sc">==</span> <span class="st">"Job_title_Data Analyst (Business, Marketing, Financial, Quantitative, etc)"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ] <span class="ot">&lt;-</span> <span class="st">"Job_title_Data Analyst"</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X_new)[</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">names</span>(X_new) <span class="sc">==</span> <span class="st">"Job_title_Data Architect"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  ] <span class="ot">&lt;-</span> <span class="st">"Job_title_DBA/Database Engineer"</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X_new)[</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">names</span>(X_new) <span class="sc">==</span> <span class="st">"Job_title_Developer Advocate"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  ] <span class="ot">&lt;-</span> <span class="st">"Job_title_Developer Relations/Advocacy"</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X_new)[</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">names</span>(X_new) <span class="sc">==</span> <span class="st">"Job_title_Machine Learning/ MLops Engineer"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  ] <span class="ot">&lt;-</span> <span class="st">"Job_title_Machine Learning Engineer"</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X_new)[</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">names</span>(X_new) <span class="sc">==</span> <span class="st">"Job_title_Manager (Program, Project, Operations, Executive-level, etc)"</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  ] <span class="ot">&lt;-</span> <span class="st">"Job_title_Program/Project Manager"</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>X_new<span class="sc">$</span>Swift_1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>X_new<span class="sc">$</span><span class="st">`</span><span class="at">Job_title_Product Manager</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this step we should split our original data into training and testing for predicting and evaluating. As we will apply original model to whole new data (2022 data), we do not split them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random seed for reproducibility</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting to train and test set</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(y_old, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>X_train_old <span class="ot">&lt;-</span> X_old[train_indices, ]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>X_test_old <span class="ot">&lt;-</span> X_old[<span class="sc">-</span>train_indices, ]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>y_train_old <span class="ot">&lt;-</span> y_old[train_indices]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>y_test_old <span class="ot">&lt;-</span> y_old[<span class="sc">-</span>train_indices]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicting" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="predicting"><span class="header-section-number">4.1.2</span> Predicting</h3>
<p>Original model was produced in <code>Original Research.R</code> file. Let’s load the model into our environment and predict the salary for our test set and new data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading original model</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../Models/original_lm.RData"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>y_pred_old <span class="ot">&lt;-</span> <span class="fu">predict</span>(original_lm, <span class="at">newdata =</span> X_test_old)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>y_pred_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(original_lm, <span class="at">newdata =</span> X_new)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluation" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="evaluation"><span class="header-section-number">4.1.3</span> Evaluation</h3>
<p>We will use 4 metrics to assess the model performance.</p>
<ul>
<li><code>Mean Squared Error (MSE)</code>: MSE is a measure of the average squared difference between the predicted and actual values in a linear model. It is calculated by taking the average of the squared residuals, where a residual is the difference between the predicted and actual values. MSE gives higher weight to larger errors, making it more sensitive to outliers.</li>
<li><code>Root Mean Squared Error (RMSE)</code>: RMSE is the square root of the MSE. It provides a measure of the average magnitude of the residuals in the original units of the target variable. RMSE is often preferred over MSE because it is in the same units as the target variable, making it more interpretable.</li>
<li><code>R-squared (R2)</code>: R2 is a statistical measure that represents the proportion of the variance in the dependent variable (target variable) that can be explained by the independent variables (predictors) in a linear model. It ranges from 0 to 1, where 1 indicates a perfect fit. R2 provides an indication of how well the linear model captures the underlying relationship between the variables.</li>
<li><code>Mean Absolute Error (MAE)</code>: MAE is a measure of the average absolute difference between the predicted and actual values in a linear model. It is calculated by taking the average of the absolute residuals, where a residual is the difference between the predicted and actual values. MAE gives equal weight to all errors, regardless of their magnitude. It is less sensitive to outliers compared to MSE.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of model performance on original test set</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>mse_old <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test_old <span class="sc">-</span> y_pred_old)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>rmse_old <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y_test_old <span class="sc">-</span> y_pred_old)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>r2_score_old <span class="ot">&lt;-</span> <span class="fu">R2</span>(y_pred_old, y_test_old)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>mae_old <span class="ot">&lt;-</span> <span class="fu">MAE</span>(y_pred_old, y_test_old)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of model performance on updated data</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>mse_new <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_new <span class="sc">-</span> y_pred_new)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>rmse_new <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y_new <span class="sc">-</span> y_pred_new)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>r2_score_new <span class="ot">&lt;-</span> <span class="fu">R2</span>(y_pred_new, y_new)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>mae_new <span class="ot">&lt;-</span> <span class="fu">MAE</span>(y_pred_new, y_new)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining results</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">c</span>(mse_old, mse_new)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">c</span>(rmse_old, rmse_new)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>r2_score <span class="ot">&lt;-</span> <span class="fu">c</span>(r2_score_old, r2_score_new)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">c</span>(mae_old, mae_new)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>data_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Original data"</span>, <span class="st">"New data"</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>lm_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_name, mse, rmse, r2_score, mae)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>lm_results</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      data_name        mse     rmse  r2_score      mae
1 Original data 2208440172 46994.04 0.2979574 36690.38
2      New data 2721621066 52169.16 0.2881017 39719.55</code></pre>
</div>
</div>
</section>
</section>
<section id="random-forest-model" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="random-forest-model"><span class="header-section-number">4.2</span> Random Forest Model</h2>
<section id="preparation-for-modelling-1" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="preparation-for-modelling-1"><span class="header-section-number">4.2.1</span> Preparation for Modelling</h3>
<p>For updating the process we also build Random Forest. Unlike previous model, we do not use <code>Country_of_residence</code> variable in our newly build model. Moreover, we also do not convert all variables to binary variable.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Original Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Updated Data</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing Country_of_residence variable</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Country_of_residence <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting variables to factor variable</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_old<span class="sc">$</span>Gender)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_old<span class="sc">$</span>Age, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"18-21"</span>, <span class="st">"22-24"</span>, <span class="st">"25-29"</span>, <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"40-44"</span>, <span class="st">"45-49"</span>, <span class="st">"50-54"</span>, <span class="st">"55-59"</span>, <span class="st">"60-69"</span>, <span class="st">"70+"</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>df_old<span class="sc">$</span>Experience <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_old<span class="sc">$</span>Experience,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt; 1 years"</span>, <span class="st">"1-3 years"</span>, <span class="st">"3-5 years"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"5-10 years"</span>, <span class="st">"10-20 years"</span>, <span class="st">"20+ years"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"I have never written code"</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Assinging final variables to rf_old</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>rf_old <span class="ot">&lt;-</span> df_old[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>)]</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rf_old)[<span class="fu">which</span>(<span class="fu">names</span>(rf_old) <span class="sc">==</span> <span class="st">"C++"</span>)] <span class="ot">&lt;-</span> <span class="st">"C_plus_plus"</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Country_of_residence <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_new<span class="sc">$</span>Gender)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_new<span class="sc">$</span>Age, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"18-21"</span>, <span class="st">"22-24"</span>, <span class="st">"25-29"</span>, <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"40-44"</span>, <span class="st">"45-49"</span>, <span class="st">"50-54"</span>, <span class="st">"55-59"</span>, <span class="st">"60-69"</span>, <span class="st">"70+"</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Experience <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_new<span class="sc">$</span>Experience,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt; 1 years"</span>, <span class="st">"1-3 years"</span>, <span class="st">"3-5 years"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"5-10 years"</span>, <span class="st">"10-20 years"</span>, <span class="st">"20+ years"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"I have never written code"</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>rf_new <span class="ot">&lt;-</span> df_new[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">20</span>)]</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>rf_new<span class="sc">$</span>Swift <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rf_new)[<span class="fu">which</span>(<span class="fu">names</span>(rf_new) <span class="sc">==</span> <span class="st">"C++"</span>)] <span class="ot">&lt;-</span> <span class="st">"C_plus_plus"</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Train test split</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(rf_old<span class="sc">$</span>Salary_est, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>rf_train_old <span class="ot">&lt;-</span> rf_old[train_indices, ]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>rf_test_old <span class="ot">&lt;-</span> rf_old[<span class="sc">-</span>train_indices, ]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicting-1" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="predicting-1"><span class="header-section-number">4.2.2</span> Predicting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Building RF model</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Salary_est <span class="sc">~</span> ., <span class="at">data =</span> rf_train_old)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting the salary</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>rf_predict_old <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, rf_test_old)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>rf_predict_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, rf_new)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluation-1" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="evaluation-1"><span class="header-section-number">4.2.3</span> Evaluation</h3>
<p>We use the same metrics for evaluating the model performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of model performance on original test set</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mse_old <span class="ot">&lt;-</span> <span class="fu">mean</span>((rf_test_old<span class="sc">$</span>Salary_est <span class="sc">-</span> rf_predict_old)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>rmse_old <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((rf_test_old<span class="sc">$</span>Salary_est <span class="sc">-</span> rf_predict_old)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>r2_score_old <span class="ot">&lt;-</span> <span class="fu">R2</span>(rf_predict_old, rf_test_old<span class="sc">$</span>Salary_est)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>mae_old <span class="ot">&lt;-</span> <span class="fu">MAE</span>(rf_predict_old, rf_test_old<span class="sc">$</span>Salary_est)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of model performance on updated data</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>mse_new <span class="ot">&lt;-</span> <span class="fu">mean</span>((rf_new<span class="sc">$</span>Salary_est <span class="sc">-</span> rf_predict_new)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>rmse_new <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((rf_new<span class="sc">$</span>Salary_est <span class="sc">-</span> rf_predict_new)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>r2_score_new <span class="ot">&lt;-</span> <span class="fu">R2</span>(rf_predict_new, rf_new<span class="sc">$</span>Salary_est)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>mae_new <span class="ot">&lt;-</span> <span class="fu">MAE</span>(rf_predict_new, rf_new<span class="sc">$</span>Salary_est)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining results</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">c</span>(mse_old, mse_new)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">c</span>(rmse_old, rmse_new)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>r2_score <span class="ot">&lt;-</span> <span class="fu">c</span>(r2_score_old, r2_score_new)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">c</span>(mae_old, mae_new)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>data_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Original data"</span>, <span class="st">"New data"</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>rf_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_name, mse, rmse, r2_score, mae)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>rf_results</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      data_name        mse     rmse  r2_score      mae
1 Original data 2467911948 49678.08 0.2677039 38469.24
2      New data 2813117074 53038.83 0.2540656 40881.27</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion</h1>
<p>As a conclusion, Linear Model (original model) performed better than Random Forest in both data. Another model or more variables should be used in the analysis.</p>
<table class="table">
<caption>Results</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Data</th>
<th>mse</th>
<th>rmse</th>
<th>r2_score</th>
<th>mae</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linear Model</td>
<td>Original data New data</td>
<td>2208440172 2721621066</td>
<td>46994.04 52169.16</td>
<td>0.2979574 0.2881017</td>
<td>36690.38 39719.55</td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>Original data New data</td>
<td>2482091811 2825551774</td>
<td>49820.60 53155.92</td>
<td>0.2637662 0.2508684</td>
<td>38549.84 40908.85</td>
</tr>
</tbody>
</table>
<section id="main-challanges-and-further-recommendations" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="main-challanges-and-further-recommendations"><span class="header-section-number">5.1</span> Main Challanges and Further Recommendations</h2>
<p>We have not faced any significant challenges during the reproduction process. However, when we try to apply the same methodology to updated data, some unmatched variables created problems. As a further recommendation, it will be much better to use common variables for the analysis in this model.</p>
</section>
</section>
<section id="bibliography" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Bibliography</h1>
<ul>
<li><a href="https://quarto.org/docs/guide/" class="uri">https://quarto.org/docs/guide/</a></li>
<li><a href="https://stackoverflow.com/" class="uri">https://stackoverflow.com/</a></li>
<li><a href="https://www.kaggle.com/" class="uri">https://www.kaggle.com/</a></li>
</ul>
<section id="ai-tool" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="ai-tool"><span class="header-section-number">6.1</span> AI tool</h2>
<p><code>ChatGPT</code> (May 24 version) is used in the following part of this analysis:</p>
<ul>
<li>Converting some parts of codes from Python to R</li>
<li>Generation of explanations for <strong>Evaluation Metrics</strong></li>
</ul>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Not recommended in to use general as it has only one category (USA). However as it has been used in the original analysis, we will use it as well for the purpose of reproduction of original results and comparing.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Answers for this question is recorded as binary variables.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="RR report_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>